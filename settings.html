<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="imgs/logo.png" type="image/png" />
    <title>OneTech | Settings</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
      integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <link rel="stylesheet" href="CSS/all.min.css" />
    <link rel="stylesheet" href="CSS/bootstrap.min.css" />
    <link rel="stylesheet" href="CSS/home-style.css" />

    <style>
      :root {
        --main-color: #2d2d27;
        --sec-color: #f9f9f9;
        --text-color: #ff9f00;
        --bg-color: #2d2d27;
        --primary-color: rgb(145, 94, 246);
        --secondary-color: rgb(255, 255, 255);
        --orange-color: #ff7e5f;
        --danger-color: #ff0000;
        --warning-color: rgb(144, 238, 144);
        --price-hover: rgb(255, 101, 40);
        --placeholder-color: rgb(186, 186, 186);
      }
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 0;
      }

      form.userInfo {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 85vh;
      }

      table {
        background-color: #fff;
        padding: 30px 40px;
        border-radius: 12px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
        border: none;
      }

      table td {
        padding: 10px 15px;
        font-weight: 500;
        color: #333;
      }

      table td input {
        width: 300px;
        padding: 10px 12px;
        border-radius: 8px;
        border: 1px solid #ccc;
        transition: all 0.3s ease;
        outline: none;
      }

      table td input:focus:not([readonly]) {
        border-color: var(--text-color);
        /* box-shadow: 0 0 5px rgba(0, 123, 255, 0.4); */
        background-color: #f8f6f1;
      }

      table td input:hover {
        background-color: #f9f9f9;
      }

      #submit,
      #reset {
        width: 100%;
        padding: 10px;
        font-weight: bold;
        background-color: var(--bg-color);
        border: none;
        border-radius: 8px;
        color: white;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      #reset {
        background-color: #6c757d;
      }

      #submit:hover {
        background-color: var(--text-color);
      }

      #reset:hover {
        background-color: #5a6268;
      }
      input[readonly] {
        background-color: #f0f0f0; /* رمادي فاتح */
        cursor: not-allowed; /* يعطي إحساس أنه مش قابل للضغط */
        color: #777; /* لون الخط باهت */
        border: 1px solid #ccc;
      }

      /* منع تأثير الهوفر على الحقول readonly */
      input[readonly]:hover {
        box-shadow: none;
        border-color: #ccc;
      }

      /* باقي الحقول العادية - تأثير لطيف عند الهوفر */
      input:not([readonly]):hover {
        border-color: var(--text-color);
        box-shadow: 0 0 5px var(--text-color);
      }

      #role {
        text-transform: capitalize;
        position: absolute;
        right: 5%;
        top: 5%;
      }

      #username {
        text-transform: capitalize;
        position: absolute;
        left: 5%;
        top: 5%;
      }
      #userTd {
        position: relative;
      }
      #role,
      #username {
        border-radius: 8px;
        color: rgba(125, 119, 119, 0.799);
        background-color: rgb(231, 229, 229);
        padding: 10px;
        /* margin-bottom: 10px; */
        margin-top: 10px;
      }
      #fname {
        margin-top: 15px;
      }
    </style>

    <script>
      window.onload = () => {
        const numWish = document.getElementById("num-wish");
        numWish.style.visibility = "hidden";
        const numCart = document.getElementById("num-cart");
        numCart.style.visibility = "hidden";

        document.getElementById("username").readOnly = true;
        document.getElementById("role").readOnly = true;
        document.getElementById("email").readOnly = true;
        document.getElementById("password").readOnly = true;
      };
    </script>
  </head>
  <body>
    <!-- Start Nav Bar -->
    <header class="header d-flex justify-content-center">
      <div class="container-fluid mx-3">
        <nav class="navbar navbar-expand-lg">
          <!-- Logo -->
          <a class="navbar-brand" href="index.html">
            <img
              src="imgs/logo.png"
              alt="OneTech Logo"
              style="height: 60px"
            /><span class="fw-bold fs-2 text-white">OneTech</span>
          </a>

          <!-- Burger Button -->
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarContent"
            aria-controls="navbarContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            Menu &nbsp; <i class="fas fa-bars"></i>
          </button>

          <!-- Navbar Content -->
          <div class="collapse navbar-collapse" id="navbarContent">
            <ul
              class="navbar-nav w-100 d-flex flex-column flex-md-row align-items-center gap-3"
            >
              <!-- Navigation Links -->
              <li class="nav-item">
                <a class="nav-link" href="index.html">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="products.html">Shop</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#footer">Contact</a>
              </li>

              <!-- Search -->
              <li class="nav-item w-75">
                <div class="search-container position-relative">
                  <form
                    class="search-form d-flex align-items-center position-relative"
                  >
                    <input
                      type="text"
                      id="searchInput"
                      class="search-input form-control"
                      placeholder="Search products..."
                    />
                    <button type="button" class="search-button btn">
                      <i class="fas fa-search search-icon"></i>
                    </button>
                  </form>
                  <div id="searchResults" class="d-none w-100"></div>
                </div>
              </li>
              <!-- Login/Register Button -->
              <li class="nav-item">
                <div id="LogReg">
                  <button class="auth-btn">
                    <a href="login.html">Login</a> |
                    <a href="registration.html">Register</a>
                  </button>
                </div>
              </li>

              <!-- Wishlist -->
              <li id="wishlist" class="nav-item">
                <a
                  href="./wish.html"
                  class="d-flex align-items-center gap-2 text-decoration-none"
                >
                  <div class="position-relative text-white">
                    <img src="imgs/heart.png" alt="wishlist" width="30" />
                    <div class="num-wish">
                      <span id="wishlistCount">0</span>
                    </div>
                  </div>
                  <span class="nav-link p-0">Wishlist</span>
                </a>
              </li>
              <!-- Cart -->
              <li class="nav-item">
                <a
                  href="./Cart-Page.html"
                  class="d-flex align-items-center gap-2 text-decoration-none"
                >
                  <div class="position-relative">
                    <img src="imgs/shopping-cart.png" alt="cart" width="30" />
                    <div class="num-cart">0</div>
                  </div>
                  <span class="nav-link p-0">Cart</span>
                </a>
              </li>

              <!-- Displayed Account Profile when Log in -->
              <li class="nav-item">
                <div class="dropdown" id="accProfile">
                  <button
                    id="accName"
                    class="auth-btn btn btn-secondary dropdown-toggle"
                    type="button"
                    data-bs-toggle="dropdown"
                    aria-expanded="false"
                  ></button>
                  <ul class="dropdown-menu">
                    <li id="adminPanel">
                      <a class="dropdown-item" href="adminPanel.html"
                        ><span
                          ><i class="fa-solid fa-user me-1"></i> Admin
                          Panel</span
                        ></a
                      >
                    </li>
                    <li id="sellerPanel">
                      <a class="dropdown-item" href="sellerPanel.html"
                        ><span
                          ><i class="fa-solid fa-user me-1"></i> Seller
                          Panel</span
                        ></a
                      >
                    </li>
                    <li>
                      <a
                        id="settings"
                        class="dropdown-item"
                        href="settings.html"
                        ><span
                          ><i class="fa-solid fa-gear me-1"></i> Settings</span
                        ></a
                      >
                    </li>
                    <li>
                      <a id="orders" class="dropdown-item" href="orders.html"
                        ><span
                          ><i class="fa-solid fa-basket-shopping me-1"></i>
                          Orders</span
                        ></a
                      >
                    </li>
                    <li>
                      <a class="dropdown-item" href=""
                        ><span id="signOut"
                          ><i
                            class="fa-solid fa-right-from-bracket fa-flip-horizontal me-1"
                          ></i>
                          Sign out</span
                        ></a
                      >
                    </li>
                  </ul>
                </div>
              </li>
            </ul>
          </div>
        </nav>
      </div>
    </header>

    <!-- End Nav Bar -->

    <form action="" class="userInfo">
      <table>
        <tr>
          <td id="user1">Username</td>
          <td id="userTd">
            <span id="username"></span><span title="User Role" id="role"></span>
          </td>
        </tr>
        <tr>
          <td>Fisrt Name</td>
          <td>
            <input placeholder="Enter Your First Name" id="fname" type="text" />
          </td>
        </tr>
        <tr>
          <td>Last Name</td>
          <td>
            <input placeholder="Enter Your last Name" id="lname" type="text" />
          </td>
        </tr>
        <tr>
          <td>E-mail</td>
          <td><input id="email" type="email" /></td>
        </tr>
        <tr>
          <td>Address</td>
          <td>
            <input
              placeholder="Enter Your First Address"
              id="address"
              type="text"
            />
          </td>
        </tr>
        <tr>
          <td>Date of Birth</td>
          <td>
            <input
              placeholder="Enter Your DOB"
              id="bod"
              type="date"
              value="1997-12-01"
            />
          </td>
        </tr>
        <tr>
          <td>Phone</td>
          <td>
            <input
              placeholder="Enter Your First Phone"
              id="phone"
              type="number"
            />
          </td>
        </tr>
        <!-- <tr>
                <td>Password</td>
                <td><input id="password"  type="password"></td>
            </tr> -->
        <tr>
          <td><input id="reset" type="reset" /></td>
          <td><input id="submit" type="submit" /></td>
        </tr>
      </table>
    </form>

    <!-- new Toast By Tarek  -->
    <div
      class="position-fixed bottom-0 end-0 p-3"
      style="z-index: 1100; margin-top: 100px; width: 280px"
    >
      <div
        id="liveToast"
        class="toast align-items-center text-white bg-success border-0"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
      >
        <div class="d-flex">
          <div class="toast-body fw-bold">تم إضافة المنتج إلى المفضلة</div>
          <button
            type="button"
            class="btn-close btn-close-white me-2 m-auto"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
      </div>
    </div>
    <!-- new Toast By Tarek  -->

    <div class="bg-footer">
      <div class="container">
        <!-- Footer Links -->
        <div class="footer-links-box py-5">
          <div class="row g-4 d-flex justify-content-center align-items-center">
            <!-- Logo & Contact Info -->
            <div class="col-12 col-lg-4 d-flex flex-column gap-3">
              <h2 class="text-warning">OneTech</h2>
              <p class="fw-bold">Got Question? Call Us 24/7</p>
              <a href="tel:+201023456789" class="text-main-color"
                >+20 102 345 6789</a
              >
              <a href="mailto:Team4@gmail.com" class="text-main-color"
                >Team4@gmail.com</a
              >
              <p>Gharbia-ITI-Tanta Branch</p>
              <div class="d-flex gap-2">
                <a href="#"
                  ><i class="fa-brands fa-facebook-f icon-link facebook"></i
                ></a>
                <a href="#"
                  ><i class="fa-brands fa-x-twitter icon-link x-twitter"></i
                ></a>
                <a href="#"
                  ><i class="fa-brands fa-youtube icon-link youtoub"></i
                ></a>
                <a href="#"
                  ><i class="fa-brands fa-google icon-link google"></i
                ></a>
              </div>
            </div>

            <!-- Find it Fast -->
            <div class="col-6 col-lg-4">
              <h6 class="fw-bold">Find it Fast</h6>
              <ul class="list-unstyled d-flex flex-column gap-2">
                <li>
                  <a href="#" class="text-secondary small"
                    >Computers & Laptops</a
                  >
                </li>
                <li>
                  <a href="#" class="text-secondary small"
                    >Smartphones & Tablets</a
                  >
                </li>
                <li>
                  <a href="#" class="text-secondary small"
                    >Cameras & Photography</a
                  >
                </li>
                <li>
                  <a href="#" class="text-secondary small">Home Appliances</a>
                </li>
                <li>
                  <a href="#" class="text-secondary small">Gaming Consoles</a>
                </li>
              </ul>
            </div>

            <!-- Customer Care -->
            <div class="col-6 col-lg-4">
              <h6 class="fw-bold">Shopping Tools</h6>
              <ul class="list-unstyled d-flex flex-column gap-2">
                <li>
                  <a href="registration.html" class="text-secondary small">Register</a>
                </li>
                <li><a href="products.html" class="text-secondary small">Shop</a></li>
                <li>
                  <a href="Cart-Page.html" class="text-secondary small">Cart</a>
                </li>
                <li>
                  <a href="wish.html" class="text-secondary small">Wish List</a>
                </li>
                <li>
                  <a href="#footer" class="text-secondary small">Customer Services</a>
                </li>
                <!-- <li><a href="#" class="text-secondary small">FAQs</a></li> -->
              </ul>
            </div>
          </div>
        </div>

        <!-- Copyright -->
        <div
          class="copyright container py-4 d-flex justify-content-between align-items-center flex-column flex-md-row"
        >
          <p class="small text-secondary mb-2 mb-md-0">
            Copyright ©2025 All rights reserved | Made by
            <span class="text-main-color">Team-4</span>
          </p>
          <div class="d-flex gap-3">
            <a href="#"><img src="./imgs/footer1.webp" alt="payment1" /></a>
            <a href="#"><img src="./imgs/footer2.webp" alt="payment2" /></a>
            <a href="#"><img src="./imgs/footer3.webp" alt="payment3" /></a>
            <a href="#"><img src="./imgs/footer4.webp" alt="payment4" /></a>
          </div>
        </div>
      </div>
    </div>

    <script>
      function showUserData() {
        const username = document.getElementById("username");
        const role = document.getElementById("role");
        const fname = document.getElementById("fname");
        const lname = document.getElementById("lname");
        const email = document.getElementById("email");
        const address = document.getElementById("address");
        const bod = document.getElementById("bod");
        const phone = document.getElementById("phone");
        const password = document.getElementById("password");

        const currentUser = JSON.parse(localStorage.getItem("currentUser"));
        const usersData = JSON.parse(localStorage.getItem("usersData"));
        const matchedUser = usersData.find(
          (user) => user.userId === currentUser.userId
        );

        // عرض البيانات
        username.textContent = matchedUser.username;
        role.textContent = matchedUser.role;
        fname.value = matchedUser.fname;
        lname.value = matchedUser.lname;
        email.value = matchedUser.email;
        address.value = matchedUser.address;
        bod.value = matchedUser.bod;
        phone.value = matchedUser.phone;
        // password.value = matchedUser.password;
      }

      function updateUserData() {
        document.getElementById("submit").addEventListener("click", (e) => {
          e.preventDefault(); // منع إعادة تحميل الصفحة

          const currentUser = JSON.parse(localStorage.getItem("currentUser"));
          const usersData = JSON.parse(localStorage.getItem("usersData"));

          const updatedUser = {
            ...currentUser, // نحتفظ بالـ userId
            username: document.getElementById("username").textContent,
            role: document.getElementById("role").textContent,
            fname: document.getElementById("fname").value,
            lname: document.getElementById("lname").value,
            email: document.getElementById("email").value,
            phone: document.getElementById("phone").value,
            address: document.getElementById("address").value,
            bod: document.getElementById("bod").value,
          };

          localStorage.setItem("currentUser", JSON.stringify(updatedUser));

          const index = usersData.findIndex(
            (user) => user.userId === currentUser.userId
          );
          if (index !== -1) {
            usersData[index] = updatedUser;
            localStorage.setItem("usersData", JSON.stringify(usersData));
          }

          showBootstrapToast("Data has been updates.", "success");
        });
      }

      showUserData();
      function updateCartCounter() {
        const currentUser = JSON.parse(localStorage.getItem("currentUser"));
        const userId = currentUser?.userId;
        const currentCart = (
          JSON.parse(localStorage.getItem("cart")) || []
        ).filter((item) => item.customerId == userId);

        let totalItems = 0;
        currentCart.forEach((item) => {
          totalItems += item.quantity;
        });
        const counterElement = document.querySelector(".num-cart");
        if (counterElement) {
          counterElement.textContent = totalItems;
        }
      }

      updateCartCounter();

      // New Fun toast by Tarek
      function showBootstrapToast(message, type = "success") {
        const toastElement = document.getElementById("liveToast");
        const toastBody = toastElement.querySelector(".toast-body");

        toastBody.textContent = message;

        toastElement.className = `toast align-items-center text-white bg-${type} border-0`;

        const toast = new bootstrap.Toast(toastElement);
        toast.show();
      }

      // New Fun toast by Tarek

      updateUserData();
      function customReset() {
        document.getElementById("reset").addEventListener("click", (e) => {
          e.preventDefault();

          const inputs = document.querySelectorAll("input");
          inputs.forEach((input) => {
            if (
              !input.readOnly &&
              input.type !== "submit" &&
              input.type !== "reset"
            ) {
              input.value = "";
            }
          });
        });
      }
      customReset();
    </script>

    <script src="JS/bootstrap.bundle.min.js"></script>
    <script src="JS/jq-3-7-1.min.js"></script>
    <script src="JS/jquery-ui.min.js"></script>
    <script src="JS/checkUserRole.js"></script>
    <script src="JS/home-search.js"></script>
    <script src="JS/wish.js"></script>
  </body>
</html>
